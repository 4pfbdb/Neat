<section class="content">
  <h1>
    {% if theme.collections and page.name == 'Products' %}
      Collections
    {% else %}
      {{ page.name }}
    {% endif %}
  </h1>

  {% if theme.collections and page.name == 'Products' %}

    <!-- Collections -->
    {% if categories.active != blank %}
      <ul class="products_list">
        {% for category in categories.active %}
          <li class="product">
            <a href="{{ category.url }}">
              {% for product in category.products limit:1 %}
                <img alt="Image of {{ product.name | escape }}" src="{{ product.image | product_image_url size: 'large' }}">
              {% endfor %}
              <i>{{ category.name }}</i>
            </a>
          </li>
        {% endfor %}
      </ul>
    {% else %}
      <p>No collections found.</p>
    {% endif %}

  {% else %}

    <!-- Products -->

    <div class="subheader">
      <ul class="categories">
      {% for category in categories.active %}
        <li class="page {% if page.full_url contains category.url %}selected{% endif %}">{{ category | link_to }}</li>
      {% endfor %}
      </ul>
    </div>

    {% paginate products from products.current by theme.products_per_page %}
      {% if products != blank %}
        <ul class="products_list">
          {% for product in products %}
          <li class="product">
            <a href="{{ product.url }}">
              <img alt="Image of {{ product.name | escape }}" src="{{ product.image | product_image_url size: 'large' }}">
              <b>{{ product.name }}</b>
              <i>{{ product.default_price | money_with_sign }}</i>
              {% if product.on_sale %}
                <em>On Sale</em>
              {% endif %}
            </a>
          </li>
          {% endfor %}
        </ul>

      {{ paginate | default_pagination }}

      {% else %}
        <p>No products found.</p>
      {% endif %}
    {% endpaginate %}
  {% endif %}
</section>
